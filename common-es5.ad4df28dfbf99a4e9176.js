!function(){function t(e,n){return(t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(e,n)}function e(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,o=r(t);if(e){var c=r(this).constructor;i=Reflect.construct(o,arguments,c)}else i=o.apply(this,arguments);return n(this,i)}}function n(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{h7wf:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("HDdC"),o=function(){function t(){i(this,t)}return c(t,null,[{key:"convertFileToImageBase64",value:function(t){return new r.a((function(e){var n=new FileReader;n.onloadend=function(t){e.next({imageData:t.target.result}),e.complete()},n.onerror=function(){return e.error()},n.readAsDataURL(t)}))}}]),t}()},oTug:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("ofXK"),o=n("bTqV"),c=n("fXoL"),a=function(){var t=function t(){i(this,t)};return t.\u0275mod=c.Ib({type:t}),t.\u0275inj=c.Hb({factory:function(e){return new(e||t)},imports:[[r.c,o.b]]}),t}()},vEUj:function(n,r,o){"use strict";o.d(r,"a",(function(){return y}));var a=o("XNiG"),s=o("fXoL"),u=o("7o/Q"),g=o("D0XW");o("zx2A");var l={leading:!0,trailing:!1},f=function(){function t(e,n,r,o){i(this,t),this.duration=e,this.scheduler=n,this.leading=r,this.trailing=o}return c(t,[{key:"call",value:function(t,e){return e.subscribe(new h(t,this.duration,this.scheduler,this.leading,this.trailing))}}]),t}(),h=function(n){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}(o,n);var r=e(o);function o(t,e,n,c,a){var s;return i(this,o),(s=r.call(this,t)).duration=e,s.scheduler=n,s.leading=c,s.trailing=a,s._hasTrailingValue=!1,s._trailingValue=null,s}return c(o,[{key:"_next",value:function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(p,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))}},{key:"_complete",value:function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}},{key:"clearThrottle",value:function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)}}]),o}(u.a);function p(t){t.subscriber.clearThrottle()}var d,b=o("vkgz"),v=o("1G5W"),m=o("ofXK"),O=["imageContainer"],P=["cropRect"],_=["image"],C=["canvas"],w=function(t,e,n,r){return{top:t,bottom:e,left:n,right:r}},y=((d=function(){function t(e){i(this,t),this.cdr=e,this.croppedImage=new s.o,this.isCropping=new s.o,this.topOffset="10px",this.bottomOffset="10px",this.leftOffset="10px",this.rightOffset="10px",this.onDestroyed$=new a.a,this.borderDragged$=new a.a}return c(t,[{key:"ngOnInit",value:function(){var t=this;this.borderDragged$.pipe(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;return function(r){return r.lift(new f(t,e,n.leading,n.trailing))}}(100),Object(b.a)((function(t){return console.log("drag ".concat(t.event.viewPortX," - ").concat(t.event.viewPortY," ").concat(t.border))})),Object(v.a)(this.onDestroyed$)).subscribe((function(e){var n=e.event,r=n.viewPortX,i=n.viewPortY,o=e.border,c=t.imgContainerElement.nativeElement.getBoundingClientRect(),a=r-c.x,s=i-c.y;switch(o){case"left":t.leftOffset=a>=0?a+"px":t.leftOffset;break;case"right":var u=c.width-a;t.rightOffset=u>=0?u+"px":t.rightOffset;break;case"top":t.topOffset=s>=0?s+"px":t.topOffset;break;case"bottom":t.bottomOffset=c.height-s+"px"}t.cdr.detectChanges()}))}},{key:"ngOnChanges",value:function(t){this.leftOffset=this.topOffset=this.rightOffset=this.bottomOffset="10px"}},{key:"ngOnDestroy",value:function(){this.onDestroyed$.next(),this.onDestroyed$.complete()}},{key:"onDragStart",value:function(t,e){this.currentlyDragging=t;var n=new Image;n.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",e.dataTransfer.setDragImage(n,0,0)}},{key:"onDragOver",value:function(t){this.borderDragged$.next({event:{viewPortX:t.clientX,viewPortY:t.clientY},border:this.currentlyDragging})}},{key:"onTouchDrag",value:function(t,e){e.preventDefault();var n=e.touches[0];this.borderDragged$.next({event:{viewPortX:n.clientX,viewPortY:n.clientY},border:t})}},{key:"cropImage",value:function(){var t=this,e=this.imageElement.nativeElement,n=this.cropRectElement.nativeElement.getBoundingClientRect(),r=this.imgContainerElement.nativeElement.getBoundingClientRect(),i=e.naturalWidth/r.width,o=e.naturalHeight/r.height,c=(n.left-r.left)*i,a=(n.top-r.top)*o,s=n.width*i,u=n.height*o;this.isCropping.emit(!0);var g=this.canvasElement.nativeElement;g.width=s,g.height=u,g.getContext("2d").drawImage(e,c,a,s,u,0,0,s,u),g.toBlob((function(e){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){t.croppedImage.emit(n.result),t.isCropping.emit(!1)}}))}}]),t}()).\u0275fac=function(t){return new(t||d)(s.Kb(s.h))},d.\u0275cmp=s.Eb({type:d,selectors:[["app-image-crop"]],viewQuery:function(t,e){var n;1&t&&(s.uc(O,!0),s.uc(P,!0),s.uc(_,!0),s.uc(C,!0)),2&t&&(s.ic(n=s.Yb())&&(e.imgContainerElement=n.first),s.ic(n=s.Yb())&&(e.cropRectElement=n.first),s.ic(n=s.Yb())&&(e.imageElement=n.first),s.ic(n=s.Yb())&&(e.canvasElement=n.first))},inputs:{imageData:"imageData"},outputs:{croppedImage:"croppedImage",isCropping:"isCropping"},features:[s.yb],decls:18,vars:7,consts:[[1,"crop-container"],[1,"image-container",3,"dragover"],["imageContainer",""],[3,"src"],["image",""],[1,"crop-rect",3,"ngStyle"],["cropRect",""],["draggable","true",1,"crop-rect-right",3,"dragstart","touchmove"],[1,"circle"],["draggable","true",1,"crop-rect-left",3,"dragstart","touchmove"],["draggable","true",1,"crop-rect-bottom",3,"dragstart","touchmove"],["draggable","true",1,"crop-rect-top",3,"dragstart","touchmove"],[2,"display","none"],["canvas",""]],template:function(t,e){1&t&&(s.Qb(0,"div"),s.Qb(1,"div",0),s.Qb(2,"div",1,2),s.Xb("dragover",(function(t){return e.onDragOver(t)})),s.Lb(4,"img",3,4),s.Qb(6,"div",5,6),s.Qb(8,"div",7),s.Xb("dragstart",(function(t){return e.onDragStart("right",t)}))("touchmove",(function(t){return e.onTouchDrag("right",t)})),s.Lb(9,"div",8),s.Pb(),s.Qb(10,"div",9),s.Xb("dragstart",(function(t){return e.onDragStart("left",t)}))("touchmove",(function(t){return e.onTouchDrag("left",t)})),s.Lb(11,"div",8),s.Pb(),s.Qb(12,"div",10),s.Xb("dragstart",(function(t){return e.onDragStart("bottom",t)}))("touchmove",(function(t){return e.onTouchDrag("bottom",t)})),s.Lb(13,"div",8),s.Pb(),s.Qb(14,"div",11),s.Xb("dragstart",(function(t){return e.onDragStart("top",t)}))("touchmove",(function(t){return e.onTouchDrag("top",t)})),s.Lb(15,"div",8),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Lb(16,"canvas",12,13),s.Pb()),2&t&&(s.Ab(4),s.gc("src",e.imageData,s.lc),s.Ab(2),s.gc("ngStyle",s.hc(2,w,e.topOffset,e.bottomOffset,e.leftOffset,e.rightOffset)))},directives:[m.k],styles:[".crop-container[_ngcontent-%COMP%]{text-align:center}.image-container[_ngcontent-%COMP%]{margin:auto;display:inline-block;position:relative}.image-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:calc(100vh - 30px);-o-object-fit:scale-down;object-fit:scale-down}.image-container[_ngcontent-%COMP%]   .crop-rect[_ngcontent-%COMP%]{position:absolute}.image-container[_ngcontent-%COMP%]   .crop-rect-bottom[_ngcontent-%COMP%], .image-container[_ngcontent-%COMP%]   .crop-rect-left[_ngcontent-%COMP%], .image-container[_ngcontent-%COMP%]   .crop-rect-right[_ngcontent-%COMP%], .image-container[_ngcontent-%COMP%]   .crop-rect-top[_ngcontent-%COMP%]{position:absolute;background-color:red}.image-container[_ngcontent-%COMP%]   .crop-rect-left[_ngcontent-%COMP%]{left:0;height:100%;width:2px;cursor:ew-resize}.image-container[_ngcontent-%COMP%]   .crop-rect-right[_ngcontent-%COMP%]{right:0;height:100%;width:2px;cursor:ew-resize}.image-container[_ngcontent-%COMP%]   .crop-rect-top[_ngcontent-%COMP%]{top:0;width:100%;height:2px;cursor:ns-resize}.image-container[_ngcontent-%COMP%]   .crop-rect-bottom[_ngcontent-%COMP%]{bottom:0;width:100%;height:2px;cursor:ns-resize}.image-container[_ngcontent-%COMP%]   .crop-rect[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{border-radius:10px;background-color:red;width:20px;height:20px;position:absolute}.image-container[_ngcontent-%COMP%]   .crop-rect-left[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%], .image-container[_ngcontent-%COMP%]   .crop-rect-right[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{top:calc(50% - 10px);left:-10px}.image-container[_ngcontent-%COMP%]   .crop-rect-bottom[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%], .image-container[_ngcontent-%COMP%]   .crop-rect-top[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{left:calc(50% - 10px);top:-10px}"],changeDetection:0}),d)}}])}();