!function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){s=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}(e,n)||t(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(self.webpackChunkprog_tools=self.webpackChunkprog_tools||[]).push([[630],{630:function(n,i,a){"use strict";a.r(i),a.d(i,{QrModule:function(){return q}});var s=a(1095),c=a(8583),u=a(5987),l=a(5310),h=a(5917),d=function(){var n=function(){function n(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._onDecodeError.bind(this),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.DEFAULT_CANVAS_SIZE,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"environment";r(this,n),this.$video=e,this.$canvas=document.createElement("canvas"),this._onDecode=t,this._preferredFacingMode=a,this._active=!1,this._paused=!1,this._flashOn=!1,"number"==typeof i?(o=i,console.warn("You're using a deprecated version of the QrScanner constructor which will be removed in the future")):this._onDecodeError=i,this.$canvas.width=o,this.$canvas.height=o,this._sourceRect={x:0,y:0,width:o,height:o},this._updateSourceRect=this._updateSourceRect.bind(this),this._onPlay=this._onPlay.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this.$video.playsInline=!0,this.$video.muted=!0,this.$video.disablePictureInPicture=!0,this.$video.addEventListener("loadedmetadata",this._updateSourceRect),this.$video.addEventListener("play",this._onPlay),document.addEventListener("visibilitychange",this._onVisibilityChange),this._qrEnginePromise=n.createQrEngine()}return o(n,[{key:"hasFlash",value:function(){if(!("ImageCapture"in window))return Promise.resolve(!1);var e=this.$video.srcObject?this.$video.srcObject.getVideoTracks()[0]:null;return e?new ImageCapture(e).getPhotoCapabilities().then(function(e){return e.fillLightMode.includes("flash")}).catch(function(e){return console.warn(e),!1}):Promise.reject("Camera not started or not available")}},{key:"isFlashOn",value:function(){return this._flashOn}},{key:"toggleFlash",value:function(){return this._setFlash(!this._flashOn)}},{key:"turnFlashOff",value:function(){return this._setFlash(!1)}},{key:"turnFlashOn",value:function(){return this._setFlash(!0)}},{key:"destroy",value:function(){this.$video.removeEventListener("loadedmetadata",this._updateSourceRect),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),this.stop(),n._postWorkerMessage(this._qrEnginePromise,"close")}},{key:"start",value:function(){var e=this;if(this._active&&!this._paused)return Promise.resolve();if("https:"!==window.location.protocol&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,this._paused=!1,document.hidden)return Promise.resolve();if(clearTimeout(this._offTimeout),this._offTimeout=null,this.$video.srcObject)return this.$video.play(),Promise.resolve();var t=this._preferredFacingMode;return this._getCameraStream(t,!0).catch(function(){return t="environment"===t?"user":"environment",e._getCameraStream()}).then(function(n){t=e._getFacingMode(n)||t,e.$video.srcObject=n,e.$video.play(),e._setVideoMirror(t)}).catch(function(t){throw e._active=!1,t})}},{key:"stop",value:function(){this.pause(),this._active=!1}},{key:"pause",value:function(){var e=this;this._paused=!0,this._active&&(this.$video.pause(),this._offTimeout||(this._offTimeout=setTimeout(function(){var n,r=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=t(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}(e.$video.srcObject?e.$video.srcObject.getTracks():[]);try{for(r.s();!(n=r.n()).done;){n.value.stop()}}catch(i){r.e(i)}finally{r.f()}e.$video.srcObject=null,e._offTimeout=null},300)))}},{key:"setGrayscaleWeights",value:function(e,t,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];n._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:e,green:t,blue:r,useIntegerApproximation:i})}},{key:"setInversionMode",value:function(e){n._postWorkerMessage(this._qrEnginePromise,"inversionMode",e)}},{key:"_onPlay",value:function(){this._updateSourceRect(),this._scanFrame()}},{key:"_onVisibilityChange",value:function(){document.hidden?this.pause():this._active&&this.start()}},{key:"_updateSourceRect",value:function(){var e=Math.min(this.$video.videoWidth,this.$video.videoHeight),t=Math.round(2/3*e);this._sourceRect.width=this._sourceRect.height=t,this._sourceRect.x=(this.$video.videoWidth-t)/2,this._sourceRect.y=(this.$video.videoHeight-t)/2}},{key:"_scanFrame",value:function(){var e=this;if(!this._active||this.$video.paused||this.$video.ended)return!1;requestAnimationFrame(function(){e.$video.readyState<=1?e._scanFrame():e._qrEnginePromise.then(function(t){return n.scanImage(e.$video,e._sourceRect,t,e.$canvas,!0)}).then(e._onDecode,function(t){e._active&&(-1!==(t.message||t).indexOf("service unavailable")&&(e._qrEnginePromise=n.createQrEngine()),e._onDecodeError(t))}).then(function(){return e._scanFrame()})})}},{key:"_onDecodeError",value:function(e){e!==n.NO_QR_CODE_FOUND&&console.log(e)}},{key:"_getCameraStream",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[{width:{min:1024}},{width:{min:768}},{}];return e&&(t&&(e={exact:e}),n.forEach(function(t){return t.facingMode=e})),this._getMatchingCameraStream(n)}},{key:"_getMatchingCameraStream",value:function(e){var t=this;return navigator.mediaDevices&&0!==e.length?navigator.mediaDevices.getUserMedia({video:e.shift()}).catch(function(){return t._getMatchingCameraStream(e)}):Promise.reject("Camera not found.")}},{key:"_setFlash",value:function(e){var t=this;return this.hasFlash().then(function(n){return n?t.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:e}]}):Promise.reject("No flash available")}).then(function(){return t._flashOn=e})}},{key:"_setVideoMirror",value:function(e){this.$video.style.transform="scaleX("+("user"===e?-1:1)+")"}},{key:"_getFacingMode",value:function(e){var t=e.getVideoTracks()[0];return t?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}}],[{key:"hasCamera",value:function(){return navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then(function(e){return e.some(function(e){return"videoinput"===e.kind})}).catch(function(){return!1}):Promise.resolve(!1)}},{key:"scanImage",value:function(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=o instanceof Worker,l=Promise.all([o||n.createQrEngine(),n._loadImage(t)]).then(function(t){var c,l,h=e(t,2),d=h[0],f=h[1];return o=d,c=e(r._drawToCanvas(f,i,a,s),2),a=c[0],l=c[1],o instanceof Worker?(u||o.postMessage({type:"inversionMode",data:"both"}),new Promise(function(e,t){var r,i,s;i=function(a){"qrResult"===a.data.type&&(o.removeEventListener("message",i),o.removeEventListener("error",s),clearTimeout(r),null!==a.data.data?e(a.data.data):t(n.NO_QR_CODE_FOUND))},s=function(e){o.removeEventListener("message",i),o.removeEventListener("error",s),clearTimeout(r),t("Scanner error: "+(e?e.message||e:"Unknown Error"))},o.addEventListener("message",i),o.addEventListener("error",s),r=setTimeout(function(){return s("timeout")},1e4);var c=l.getImageData(0,0,a.width,a.height);o.postMessage({type:"decode",data:c},[c.data.buffer])})):new Promise(function(e,t){var r=setTimeout(function(){return t("Scanner error: timeout")},1e4);o.detect(a).then(function(r){r.length?e(r[0].rawValue):t(n.NO_QR_CODE_FOUND)}).catch(function(e){return t("Scanner error: "+(e.message||e))}).finally(function(){return clearTimeout(r)})})});return i&&c&&(l=l.catch(function(){return n.scanImage(t,null,o,a,s)})),l=l.finally(function(){u||n._postWorkerMessage(o,"close")})}},{key:"createQrEngine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.WORKER_PATH;return("BarcodeDetector"in window?BarcodeDetector.getSupportedFormats():Promise.resolve([])).then(function(t){return-1!==t.indexOf("qr_code")?new BarcodeDetector({formats:["qr_code"]}):new Worker(e)})}},{key:"_drawToCanvas",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n=n||document.createElement("canvas");var i=t&&t.x?t.x:0,o=t&&t.y?t.y:0,a=t&&t.width?t.width:e.width||e.videoWidth,s=t&&t.height?t.height:e.height||e.videoHeight;r||n.width===a&&n.height===s||(n.width=a,n.height=s);var c=n.getContext("2d",{alpha:!1});return c.imageSmoothingEnabled=!1,c.drawImage(e,i,o,a,s,0,0,n.width,n.height),[n,c]}},{key:"_loadImage",value:function(e){if(e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||window.ImageBitmap&&e instanceof window.ImageBitmap||window.OffscreenCanvas&&e instanceof window.OffscreenCanvas)return Promise.resolve(e);if(e instanceof Image)return n._awaitImageLoad(e).then(function(){return e});if(e instanceof File||e instanceof Blob||e instanceof URL||"string"==typeof e){var t=new Image;return t.src=e instanceof File||e instanceof Blob?URL.createObjectURL(e):e,n._awaitImageLoad(t).then(function(){return(e instanceof File||e instanceof Blob)&&URL.revokeObjectURL(t.src),t})}return Promise.reject("Unsupported image type.")}},{key:"_awaitImageLoad",value:function(e){return new Promise(function(t,n){var r,i;e.complete&&0!==e.naturalWidth?t():(r=function(){e.removeEventListener("load",r),e.removeEventListener("error",i),t()},i=function(){e.removeEventListener("load",r),e.removeEventListener("error",i),n("Image load error")},e.addEventListener("load",r),e.addEventListener("error",i))})}},{key:"_postWorkerMessage",value:function(e,t,n){return Promise.resolve(e).then(function(e){e instanceof Worker&&e.postMessage({type:t,data:n})})}}]),n}();return n.DEFAULT_CANVAS_SIZE=400,n.NO_QR_CODE_FOUND="No QR code found",n.WORKER_PATH="qr-scanner-worker.min.js",n}(),f=a(8307),v=a(3190),m=a(5304),g=a(7716),p=a(9075),_=a(6758),y=["cropComponent"];function b(e,t){if(1&e&&(g.TgZ(0,"div",4),g._uU(1),g.qZA()),2&e){var n=g.oxw();g.xp6(1),g.Oqu(n.qrResult)}}function w(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1," Please wait while we scan for a qr code in the image...\n"),g.qZA())}function k(e,t){if(1&e){var n=g.EpF();g.TgZ(0,"div"),g.TgZ(1,"app-image-crop",6,7),g.NdJ("croppedImage",function(e){return g.CHM(n),g.oxw(2).onImageCrop(e)}),g.qZA(),g.TgZ(3,"button",8),g.NdJ("click",function(){return g.CHM(n),g.oxw(2).onCropClicked()}),g._uU(4," CROP "),g.qZA(),g.qZA()}if(2&e){var r=g.oxw(2);g.xp6(1),g.Q6J("imageData",r.errImg.imageData)}}function E(e,t){if(1&e&&(g.TgZ(0,"div",5),g._uU(1),g.YNc(2,k,5,1,"div",1),g.qZA()),2&e){var n=g.oxw();g.xp6(1),g.hij(" ",n.qrError,". If you think the image contains qr code please crop the image to just contain the qr Code. Use the red box below over the image to select the qr portion and click on the crop button at the bottom of the image. "),g.xp6(1),g.Q6J("ngIf",n.errImg)}}d.WORKER_PATH="/assets/service-workers/qr-scanner-worker.min.js";var C,I,O=[{path:"",component:(C=function(){function e(t,n){r(this,e),this.cdr=t,this.titleService=n,this.isScanning=!1,n.setTitle("QR Code Reader")}return o(e,[{key:"content",set:function(e){this.cropComponent=e}},{key:"ngOnInit",value:function(){}},{key:"onError",value:function(e,t){var n=this;return(0,h.of)(t).pipe((0,f.b)(function(e){n.qrError="Unable to find qr code in the image",console.warn(e)}),(0,v.w)(function(){return l.i.convertFileToImageBase64(e)}),(0,f.b)(function(e){return n.errImg=e}))}},{key:"onErrorB64",value:function(e,t){var n=this;return(0,h.of)(t).pipe((0,f.b)(function(e){n.qrError="Unable to find qr code in the image",console.warn(e)}),(0,f.b)(function(){return n.errImg={imageData:e}}))}},{key:"scanFile",value:function(e){var t=this;(0,h.of)(1).pipe((0,f.b)(function(){t.qrError=t.qrResult="",t.isScanning=!0,t.cdr.detectChanges()}),(0,v.w)(function(){return d.scanImage(e)}),(0,f.b)(function(e){return t.qrResult=e}),(0,m.K)(function(n){return t.onError(e,n)}),(0,f.b)(function(){t.isScanning=!1,t.cdr.detectChanges()})).subscribe()}},{key:"scanFileB64",value:function(e){var t=this;(0,h.of)(1).pipe((0,f.b)(function(){t.qrError=t.qrResult="",t.isScanning=!0,t.cdr.detectChanges()}),(0,v.w)(function(){var t=document.createElement("img");return t.src=e,d.scanImage(t)}),(0,f.b)(function(e){return t.qrResult=e}),(0,m.K)(function(n){return t.onErrorB64(e,n)}),(0,f.b)(function(){t.isScanning=!1,t.cdr.detectChanges()})).subscribe()}},{key:"fileChanged",value:function(e){this.scanFile(e.target.files[0])}},{key:"onImageCrop",value:function(e){this.scanFileB64(e)}},{key:"onCropClicked",value:function(){this.cropComponent&&this.cropComponent.cropImage()}}]),e}(),C.\u0275fac=function(e){return new(e||C)(g.Y36(g.sBO),g.Y36(p.Dx))},C.\u0275cmp=g.Xpm({type:C,selectors:[["app-qr"]],viewQuery:function(e,t){var n;1&e&&g.Gf(y,5),2&e&&g.iGM(n=g.CRH())&&(t.content=n.first)},decls:5,vars:3,consts:[["class","success",4,"ngIf"],[4,"ngIf"],["class","error",4,"ngIf"],["type","file","accept","image/*",3,"change"],[1,"success"],[1,"error"],[3,"imageData","croppedImage"],["cropComponent",""],["mat-raised-button","","mat-primary","",3,"click"]],template:function(e,t){1&e&&(g.YNc(0,b,2,1,"div",0),g.YNc(1,w,2,0,"div",1),g.YNc(2,E,3,2,"div",2),g._uU(3,"\nUpload image with QR code\n"),g.TgZ(4,"input",3),g.NdJ("change",function(e){return t.fileChanged(e)}),g.qZA()),2&e&&(g.Q6J("ngIf",t.qrResult),g.xp6(1),g.Q6J("ngIf",t.isScanning),g.xp6(1),g.Q6J("ngIf",t.qrError&&!t.isScanning))},directives:[c.O5,_.d,s.lW],styles:[".success[_ngcontent-%COMP%]{color:rgba(25,102,63,.582)}.error[_ngcontent-%COMP%]{color:red}"],changeDetection:0}),C),data:{title:"QR Code Reader",description:"Read the data in QR code"}}],R=function(){var e=function e(){r(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[u.Bz.forChild(O)],u.Bz]}),e}(),S=a(712),q=((I=function e(){r(this,e)}).\u0275fac=function(e){return new(e||I)},I.\u0275mod=g.oAB({type:I}),I.\u0275inj=g.cJS({imports:[[c.ez,S.K,R,s.ot]]}),I)}}])}();